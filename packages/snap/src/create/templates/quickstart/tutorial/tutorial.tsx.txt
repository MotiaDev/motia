import { workbenchXPath, TutorialStep } from '@motiadev/workbench'

export const steps: TutorialStep[] = [
  {
    title: 'Welcome to Motia',
    image: {
      height: 200,
      src: 'https://github.com/MotiaDev/motia/raw/main/packages/docs/public/github-readme-banner.png',
    },
    description: () => (
      <p>
        Build production-grade backends with a single primitive. Motia unifies APIs, background jobs, queues, workflows,
        and AI agents in one system with built-in state management, streaming, and observability.
        <br />
        <br />
        This quickstart will walk you through the basic building blocks: <b>API Steps</b> and <b>Event Steps</b>.
      </p>
    ),
  },

  // API Step

  {
    elementXpath: workbenchXPath.sidebarContainer,
    title: 'Step Configuration',
    description: () => (
      <p>
        All Steps are defined by two main components: the <b>configuration</b> and the <b>handler</b>.
        <br />
        <br />
        The configuration defines the step's behavior - its type, name, which events it emits or subscribes to, and
        which flows it belongs to.
      </p>
    ),
    before: [
      { type: 'click', selector: workbenchXPath.flows.previewButton('GetHello') },
      { type: 'click', selector: workbenchXPath.flows.feature('step-configuration') },
    ],
  },
  {
    elementXpath: workbenchXPath.sidebarContainer,
    title: 'API Step Configuration',
    description: () => (
      <p>
        API Steps expose HTTP endpoints. The <b>method</b> and <b>path</b> define how external clients can reach this
        step.
        <br />
        <br />
        The <b>emits</b> attribute specifies which topics this step publishes to, enabling other steps to react to this
        API call.
      </p>
    ),
    before: [{ type: 'click', selector: workbenchXPath.flows.feature('api-configuration') }],
  },
  {
    elementXpath: workbenchXPath.sidebarContainer,
    title: 'Step Handler',
    description: () => (
      <p>
        The <b>handler</b> is the function that executes when the step is triggered.
        <br />
        <br />
        API handlers receive the request as the first argument and a context object with utilities like <b>
          emit
        </b> and <b>logger</b>.
      </p>
    ),
    before: [{ type: 'click', selector: workbenchXPath.flows.feature('handler') }],
  },
  {
    elementXpath: workbenchXPath.sidebarContainer,
    title: 'Event Emitter',
    description: () => (
      <p>
        The <b>emit</b> function publishes events to topics. Other steps can subscribe to these topics to react to
        events.
        <br />
        <br />
        This is how Steps communicate in Motia's event-driven architecture.
      </p>
    ),
    before: [{ type: 'click', selector: workbenchXPath.flows.feature('event-emitter') }],
  },

  // Event Step

  {
    elementXpath: workbenchXPath.sidebarContainer,
    title: 'Event Step',
    link: 'https://www.motia.dev/docs/concepts/steps#triggers-event',
    description: () => (
      <p>
        <b>Event Steps</b> subscribe to topics and execute when events are published.
        <br />
        <br />
        They can only be triggered internally, through topic subscriptions.
      </p>
    ),
    before: [
      { type: 'click', selector: workbenchXPath.flows.previewButton('HelloFromTypeScript') },
      { type: 'click', selector: workbenchXPath.flows.feature('step-configuration') },
    ],
  },
  {
    elementXpath: workbenchXPath.sidebarContainer,
    title: 'Event Subscriptions',
    description: () => (
      <p>
        The <b>subscribes</b> attribute defines which topics this step listens to.
        <br />
        <br />
        In this example, the step subscribes to the "hello" topic emitted by the API step.
      </p>
    ),
    before: [{ type: 'click', selector: workbenchXPath.flows.feature('event-subscriptions') }],
  },
  {
    elementXpath: workbenchXPath.sidebarContainer,
    title: 'Input Schema',
    description: () => (
      <p>
        The <b>input</b> attribute defines the expected data structure from the subscribed topic using a zod schema.
        <br />
        <br />
        This acts as a contract - the emitting step must provide data matching this schema.
      </p>
    ),
    before: [{ type: 'click', selector: workbenchXPath.flows.feature('input-schema') }],
  },
  {
    elementXpath: workbenchXPath.sidebarContainer,
    title: 'Event Handler',
    description: () => (
      <p>
        Event handlers receive the event data as the first argument, matching the input schema.
        <br />
        <br />
        The second argument provides the same utilities as API handlers: <b>emit</b>, <b>logger</b>, etc.
      </p>
    ),
    before: [{ type: 'click', selector: workbenchXPath.flows.feature('handler') }],
  },

  // End

  {
    title: "You're all set!",
    link: 'https://www.motia.dev/docs',
    description: () => (
      <p>
        You now understand the basics of Motia steps and event-driven architecture.
        <br />
        <br />
        Check out the{' '}
        <a href="https://www.motia.dev/docs/concepts/overview" target="_blank">
          documentation
        </a>{' '}
        to learn more, or join our{' '}
        <a href="https://discord.com/invite/nJFfsH5d6v" target="_blank">
          Discord community
        </a>
        .
      </p>
    ),
    before: [{ type: 'click', selector: workbenchXPath.closePanelButton }],
  },
]
