---
title: iii Configuration (config.yml)
description: Configure your application with iii config.yml - the central configuration file for your project.
---

The `config.yml` file is the central configuration for your application. It replaces the previous `motia.config.ts` file.

<Callout type="info">
**Migration Note**: The `motia.config.ts` file has been replaced by `config.yml`. If you are upgrading from an older version, you will need to migrate your configuration to the new YAML format.
</Callout>

## Quick Start

Create a `config.yml` file in your project root:

```yaml title="config.yml"
# All configuration is optional - sensible defaults are used
```

That's it. The application works out of the box with sensible defaults.

---

## Critical Requirement: ES Modules

<Callout type="error">
**Your `package.json` must have `"type": "module"`**

The framework uses ES modules internally. Without this setting, you'll get import/export errors at runtime.
</Callout>

```json title="package.json"
{
  "name": "my-app",
  "type": "module",
  "scripts": {
    "dev": "motia dev",
    "start": "motia start",
    "build": "motia build"
  }
}
```

---

## Configuration Options

The `config.yml` file supports the following top-level keys:

| Option | Type | Description |
|--------|------|-------------|
| `port` | `number` | Server port (default: 3000) |
| `host` | `string` | Server host (default: localhost) |
| `redis` | `object` | Redis connection settings |
| `streamAuth` | `object` | Secure real-time streams |

---

## Redis Configuration

The application uses Redis for internal coordination. By default, it includes an embedded in-memory Redis server - no installation required.

### Default: In-Memory Redis

```yaml title="config.yml"
# Uses embedded Redis by default - no configuration needed
```

### External Redis

For production or when you have your own Redis instance:

```yaml title="config.yml"
redis:
  useMemoryServer: false
  host: ${REDIS_HOST:-localhost}
  port: ${REDIS_PORT:-6379}
  password: ${REDIS_PASSWORD}
  username: ${REDIS_USERNAME}
  db: 0
```

### Skip Embedded Redis

When creating a new project, skip the embedded Redis binary:

```bash
npx motia create my-app --skip-redis
```

This creates a project configured for external Redis from the start.

### Redis Options

| Option | Type | Description |
|--------|------|-------------|
| `useMemoryServer` | `boolean` | Use embedded Redis (default: `true`) |
| `host` | `string` | Redis host |
| `port` | `number` | Redis port |
| `password` | `string` | Redis password |
| `username` | `string` | Redis username (Redis 6.0+) |
| `db` | `number` | Database number (default: `0`) |

---

## Stream Authentication

Secure your real-time streams by authenticating WebSocket connections. Stream authentication is configured in your stream files and application code rather than in `config.yml`.

See [Real-time Streams](/docs/development-guide/streams) for details on configuring stream authentication.

---

## Built-in Features

### Body Parsers

The framework automatically parses JSON, URL-encoded, and text request bodies with a 1GB limit.

### Raw Body Access

The raw request body is available as `req.rawBody`. Useful for webhook signature verification:

<Tabs items={['TypeScript', 'JavaScript']}>
<Tab value='TypeScript'>

```typescript title="steps/webhook.step.ts"
import { type Handlers, type StepConfig } from 'motia'

export const config = {
  name: 'StripeWebhook',
  description: 'Handle Stripe webhook events',
  triggers: [
    { type: 'api', path: '/webhooks/stripe', method: 'POST' },
  ],
  flows: ['payments'],
} as const satisfies StepConfig

export const handler: Handlers<typeof config> = async (req, { logger }) => {
  const signature = req.headers['stripe-signature']
  const rawBody = req.rawBody

  const isValid = verifyStripeSignature(rawBody, signature)

  if (!isValid) {
    return { status: 401, body: { error: 'Invalid signature' } }
  }

  return { status: 200, body: { received: true } }
}
```

</Tab>
<Tab value='JavaScript'>

```javascript title="steps/webhook.step.js"
const config = {
  name: 'StripeWebhook',
  description: 'Handle Stripe webhook events',
  triggers: [
    { type: 'api', path: '/webhooks/stripe', method: 'POST' },
  ],
  flows: ['payments'],
}

const handler = async (req, { logger }) => {
  const signature = req.headers['stripe-signature']
  const rawBody = req.rawBody

  const isValid = verifyStripeSignature(rawBody, signature)

  if (!isValid) {
    return { status: 401, body: { error: 'Invalid signature' } }
  }

  return { status: 200, body: { received: true } }
}

module.exports = { config, handler }
```

</Tab>
</Tabs>

---

## What's Next?

<Cards>
  <Card href="/docs/development-guide/streams" title="Streams">
    Build real-time features
  </Card>

  <Card href="/docs/development-guide/state-management" title="State Management">
    Persistent storage across Steps
  </Card>
</Cards>
