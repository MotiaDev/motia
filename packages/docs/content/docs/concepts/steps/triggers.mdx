---
title: Triggers
description: Understanding how Steps are triggered - API, Event, and Cron
---

## How Steps Are Triggered

Every Step has a `type` that defines when it runs:

| Type | Triggers when... | Use for |
|------|------------------|---------|
| `api` | An HTTP request arrives | REST endpoints, webhooks |
| `event` | An event is emitted | Background tasks, workflows |
| `cron` | A schedule fires | Periodic jobs, cleanups |

---

<Tabs items={['API', 'Event', 'Cron']}>
<Tab value='API'>

## API Trigger

API Trigger expose HTTP endpoints. When a request hits the path, your handler runs.

### Basic Example

<Tabs items={['TypeScript', 'JavaScript', 'Python']}>
  <Tab value="TypeScript">
    ```typescript
    import { ApiRouteConfig, Handlers } from 'motia'

    export const config: ApiRouteConfig = {
      name: 'GetUser',
      type: 'api',
      path: '/users/:id',
      method: 'GET'
    }

    export const handler: Handlers['GetUser'] = async (req, { logger }) => {
      const userId = req.pathParams.id
      logger.info('Getting user', { userId })

      return {
        status: 200,
        body: { id: userId, name: 'John Doe' }
      }
    }
    ```
  </Tab>
  <Tab value="JavaScript">
    ```javascript
    const config = {
      name: 'GetUser',
      type: 'api',
      path: '/users/:id',
      method: 'GET'
    }

    const handler = async (req, { logger }) => {
      const userId = req.pathParams.id
      logger.info('Getting user', { userId })

      return {
        status: 200,
        body: { id: userId, name: 'John Doe' }
      }
    }

    module.exports = { config, handler }
    ```
  </Tab>
  <Tab value="Python">
    ```python
    config = {
        "name": "GetUser",
        "type": "api",
        "path": "/users/:id",
        "method": "GET"
    }

    async def handler(req, context):
        user_id = req.get("pathParams", {}).get("id")
        context.logger.info("Getting user", {"userId": user_id})

        return {
            "status": 200,
            "body": {"id": user_id, "name": "John Doe"}
        }
    ```
  </Tab>
</Tabs>

ðŸ‘‰ That's it! You now have a `GET /users/:id` endpoint.

---

### Handler Signature

```typescript
handler(req, ctx)
```

**`req`** - The HTTP request:

| Property | Description |
|----------|-------------|
| `body` | Request body (parsed JSON) |
| `headers` | HTTP headers |
| `pathParams` | URL parameters (`:id` â†’ `{ id: '123' }`) |
| `queryParams` | Query string parameters |

**`ctx`** - [Context object](#context) with `logger`, `emit`, `state`, `streams`, `traceId`.

**Return** - Must include:

| Property | Description |
|----------|-------------|
| `status` | HTTP status code (200, 404, 500, etc.) |
| `body` | Response body (JSON) |
| `headers` | Optional response headers |

---

### Config

Required:

| Property | Type | Description |
|----------|------|-------------|
| `name` | `string` | Unique identifier |
| `type` | `'api'` | Marks this as an API Step |
| `path` | `string` | URL path (supports `:params`) |
| `method` | `string` | HTTP method (GET, POST, PUT, DELETE) |

Optional:

| Property | Type | Description |
|----------|------|-------------|
| `description` | `string` | Human-readable notes |
| `emits` | `string[]` | Events this Step can emit |
| `flows` | `string[]` | Flows this Step belongs to |
| `bodySchema` | `ZodSchema \| PydanticModel` | Validate request body |
| `responseSchema` | `ZodSchema \| PydanticModel` | Document response shape |
| `middleware` | `ApiMiddleware[]` | Pre-handler functions |

</Tab>

<Tab value='Event'>

## Event Trigger

Event Trigger run when an event is emitted. Use for background tasks and async workflows.

### Basic Example

<Tabs items={['TypeScript', 'JavaScript', 'Python']}>
  <Tab value="TypeScript">
    ```typescript
    import { EventConfig, Handlers } from 'motia'

    export const config: EventConfig = {
      name: 'ProcessMessage',
      type: 'event',
      subscribes: ['message.sent']
    }

    export const handler: Handlers['ProcessMessage'] = async (input, { logger }) => {
      logger.info('Processing message:', input)
      // Do async work here
    }
    ```
  </Tab>
  <Tab value="JavaScript">
    ```javascript
    const config = {
      name: 'ProcessMessage',
      type: 'event',
      subscribes: ['message.sent']
    }

    const handler = async (input, { logger }) => {
      logger.info('Processing message:', input)
      // Do async work here
    }

    module.exports = { config, handler }
    ```
  </Tab>
  <Tab value="Python">
    ```python
    config = {
        "name": "ProcessMessage",
        "type": "event",
        "subscribes": ["message.sent"]
    }

    async def handler(input, context):
        context.logger.info("Processing message:", {"input": input})
        # Do async work here
    ```
  </Tab>
</Tabs>

ðŸ‘‰ This Step runs whenever someone emits `message.sent`.

---

### Handler Signature

```typescript
handler(input, ctx)
```

**`input`** - Data from the emitted event.

**`ctx`** - [Context object](#context) with `logger`, `emit`, `state`, `streams`, `traceId`.

---

### Config

Required:

| Property | Type | Description |
|----------|------|-------------|
| `name` | `string` | Unique identifier |
| `type` | `'event'` | Marks this as an Event Step |
| `subscribes` | `string[]` | Event topics to listen to |

Optional:

| Property | Type | Description |
|----------|------|-------------|
| `description` | `string` | Human-readable notes |
| `emits` | `string[]` | Events this Step can emit |
| `flows` | `string[]` | Flows this Step belongs to |
| `input` | `ZodSchema \| PydanticModel` | Validate input data |

</Tab>

<Tab value='Cron'>

## Cron Trigger

Cron Trigger run on a schedule. Use for periodic tasks like cleanup jobs or reports.

### Basic Example

<Tabs items={['TypeScript', 'JavaScript', 'Python']}>
  <Tab value="TypeScript">
    ```typescript
    import { CronConfig, Handlers } from 'motia'

    export const config: CronConfig = {
      name: 'DailyCleanup',
      type: 'cron',
      cron: '0 0 * * *' // Every day at midnight
    }

    export const handler: Handlers['DailyCleanup'] = async ({ logger }) => {
      logger.info('Running daily cleanup')
      // Do cleanup work here
    }
    ```
  </Tab>
  <Tab value="JavaScript">
    ```javascript
    const config = {
      name: 'DailyCleanup',
      type: 'cron',
      cron: '0 0 * * *' // Every day at midnight
    }

    const handler = async ({ logger }) => {
      logger.info('Running daily cleanup')
      // Do cleanup work here
    }

    module.exports = { config, handler }
    ```
  </Tab>
  <Tab value="Python">
    ```python
    config = {
        "name": "DailyCleanup",
        "type": "cron",
        "cron": "0 0 * * *"  # Every day at midnight
    }
  
    async def handler(context):
        context.logger.info("Running daily cleanup")
        # Do cleanup work here
    ```
  </Tab>
</Tabs>

ðŸ‘‰ This Step runs automatically every day at midnight.

---

### Handler Signature

```typescript
handler(ctx)
```

**`ctx`** - [Context object](#context) with `logger`, `emit`, `state`, `streams`, `traceId`.

---

### Config

Required:

| Property | Type | Description |
|----------|------|-------------|
| `name` | `string` | Unique identifier |
| `type` | `'cron'` | Marks this as a Cron Step |
| `cron` | `string` | Cron expression for schedule |

Optional:

| Property | Type | Description |
|----------|------|-------------|
| `description` | `string` | Human-readable notes |
| `emits` | `string[]` | Events this Step can emit |
| `flows` | `string[]` | Flows this Step belongs to |

---

### Cron Expressions

| Expression | Description |
|------------|-------------|
| `* * * * *` | Every minute |
| `0 * * * *` | Every hour |
| `0 0 * * *` | Every day at midnight |
| `0 9 * * 1` | Every Monday at 9 AM |
| `0 0 1 * *` | First day of every month |
| `*/15 * * * *` | Every 15 minutes |

ðŸ‘‰ Use [crontab.guru](https://crontab.guru) to test and understand cron expressions.

</Tab>
</Tabs>

---

## Context

Every handler receives a `ctx` object with these tools:

| Property | Description | Example |
|----------|-------------|---------|
| `logger` | Structured logging | `logger.info('User created', { userId })` |
| `emit` | Trigger other Steps | `await emit({ topic: 'user.created', data })` |
| `state` | Persistent key-value storage | `await state.set(traceId, 'key', value)` |
| `streams` | Real-time data channels | `await streams.chat.set('room', 'msg', data)` |
| `traceId` | Unique ID for this execution | Used for tracking workflows |

---

## What's Next?

<Cards>
  <Card href="/docs/concepts/steps/steps" title="ðŸ“ Defining Steps">
    Learn the fundamentals of creating Steps
  </Card>
  
  <Card href="/docs/development-guide/state-management" title="ðŸ”„ State Management">
    Share data between Steps
  </Card>
</Cards>
